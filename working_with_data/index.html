<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <meta name="author" content="Erik Straub">
  
  <title>Working with Data - Oddworks SDK for Android</title>
  

  <link rel="shortcut icon" href="../assets/favicon.ico">
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  <link rel="stylesheet" href="../css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../css/theme_extra.css" type="text/css" />
  <link rel="stylesheet" href="../css/highlight.css">

  
  <script>
    // Current page data
    var mkdocs_page_name = "Working with Data";
    var mkdocs_page_input_path = "working_with_data.md";
    var mkdocs_page_url = "/working_with_data/";
  </script>
  
  <script src="../js/jquery-2.1.1.min.js"></script>
  <script src="../js/modernizr-2.8.3.min.js"></script>
  <script type="text/javascript" src="../js/highlight.pack.js"></script>
  <script src="../js/theme.js"></script> 
  <script src="../javadoc/beta-1.0.0/script.js"></script>

  
  <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-68853545-3', 'android.guide.oddworks.io');
      ga('send', 'pageview');
  </script>
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
      <div class="wy-side-nav-search">
        <a href=".." class="icon icon-home"> Oddworks SDK for Android</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        <ul class="current">
          
            <li>
    <ul class="subnav">
    <li><span>Welcome</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="..">Introduction</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../overview/">Oddworks Overview</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sample_application/">Sample Application</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Getting Started</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../setup/">Library and Project Setup</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../getting_started/">Configuring your App</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../data_models/">Understanding the SDK Data Models</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>The Basics of Oddworks</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../initialize_api_calls/">Initialize API Calls</a>
        
    </li>

        
            
    <li class="toctree-l1 current">
        <a class="current" href="./">Working with Data</a>
        
            <ul>
            
                <li class="toctree-l3"><a href="#getting-information-from-views">Getting Information from Views</a></li>
                
                    <li><a class="toctree-l4" href="#configure-data">Configure Data</a></li>
                
                    <li><a class="toctree-l4" href="#apply-data">Apply Data</a></li>
                
            
            </ul>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../search/">Search</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Authenticating Users</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../auth_process/">Authentication Process</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../entitlements/">Entitlements</a>
        
    </li>

        
    </ul>
<li>
          
            <li>
    <ul class="subnav">
    <li><span>Capturing Metrics</span></li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../metrics_configuration/">Configuration</a>
        
    </li>

        
            
    <li class="toctree-l1 ">
        <a class="" href="../sending_metrics/">Sending Metrics</a>
        
    </li>

        
    </ul>
<li>
          
        </ul>
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="..">Oddworks SDK for Android</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="..">Docs</a> &raquo;</li>
    
      
        
          <li>The Basics of Oddworks &raquo;</li>
        
      
    
    <li>Working with Data</li>
    <li class="wy-breadcrumbs-aside">
      
        
          <a href="https://github.com/oddnetworks/odd-sample-apps" class="icon icon-github"> Edit on GitHub</a>
        
      
    </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="getting-information-from-views">Getting Information from Views</h1>
<h2 id="configure-data">Configure Data</h2>
<p>In our sample application, we've pulled down an <code>OddView</code> and called it <code>homeView</code>. In order to extract information from it we'll use some convienence methods from the superclass of <code>OddView</code>, <code>OddObject</code>. Before we do that, we'll need to setup some variables in our <code>HomeActivity</code>.</p>
<pre><code class="java">// app/java/sample.oddworks.com.myoddworksapplication/HomeActivity

// ...
public class HomeActivity extends AppCompatActivity {
    // Constants
    private static final String FEATURED_MEDIA = &quot;featuredMedia&quot;;
    private static final String FEATURED_COLLECTION = &quot;featuredCollections&quot;;
    private static final String FEATURED_ENTITIES = &quot;entities&quot;;

    // Data
    private Context context;
    private OddView homeView;
    private Media featuredMedia;
    private OddCollection featuredCollection;
    private List&lt;OddObject&gt; featuredCollectionEntities;

    // ...
</code></pre>

<p>Now, in our <code>onCreate</code> method after <code>setContentView</code> is called, we need to set our <code>context</code>.</p>
<pre><code class="java">@Override
protected void onCreate(Bundle savedInstanceState) {
    super.onCreate(savedInstanceState);
    setContentView(R.layout.activity_home);
    context = this;
}
</code></pre>

<p>After setting our context we'll call a new method called <code>configureData</code>.</p>
<pre><code class="java">// app/java/sample.oddworks.com.myoddworksapplication/HomeActivity

// ...
private void configureData() {
    homeView = OddApp.getInstance().getHomeView();
    List&lt;Identifier&gt; mediaIds = homeView.getIdentifiersByRelationship(FEATURED_MEDIA);
    List&lt;Identifier&gt; collectionIds = homeView.getIdentifiersByRelationship(FEATURED_COLLECTION);

    if (mediaIds != null &amp;&amp; !mediaIds.isEmpty()) {
        Identifier featuredMediaId = mediaIds.get(0);
        featuredMedia = (Media) OddStore.getInstance().getObject(featuredMediaId);
    }
    if (collectionIds != null &amp;&amp; !collectionIds.isEmpty()) {
        Identifier featuredCollectionId = collectionIds.get(0);
        featuredCollection = (OddCollection) OddStore.getInstance().getObject(featuredCollectionId);
    }
    if (featuredCollection != null) {
        featuredCollectionEntities = featuredCollection.getIncludedByRelationship(FEATURED_ENTITIES);
    }
}
// ...
</code></pre>

<p>There's a lot going on here, so let's take a minute to walk through the code. We are first getting the <code>homeView</code> from our main application class. In the Oddworks dashboard we've set up relationships on this View with the keys of "featuredMedia and "featuredCollections". We use the <code>getIdentifiersByRelationship</code> so that we can use the <code>OddStore</code>'s <code>getObject</code> method to retrieve the featured media and featured collection objects later in the method. We check to make sure that each List of Identifiers is not null or empty and grab the object from the <code>OddStore</code>. We take this a step further with the <code>getIncludedByRelationship</code> method called on the <code>featuredCollection</code>. This will give us a list of <code>OddObject</code>s that can be used in a RecyclerView. <em>Note: We're casting the objects in the <code>featuredCollectionEntities</code> to <code>OddObject</code>s because it may contain any combination of data types.</em></p>
<h2 id="apply-data">Apply Data</h2>
<h3 id="displaying-a-preview-image">Displaying a Preview Image</h3>
<p>Now that we've extracted the data we need from the <code>homeView</code> we're going to show the user the preview image for the <code>featuredMedia</code> object. In order to render an image, we're going to rely on the <a href="https://github.com/bumptech/glide">Glide</a> library, though there are many other options such as <a href="https://github.com/square/picasso">Picasso</a>, <a href="https://github.com/nostra13/Android-Universal-Image-Loader">ImageLoader</a>, and <a href="https://github.com/facebook/fresco">Fresco</a>. Add the Glide library to your project via Gradle or Maven.</p>
<p>After calling the <code>configureData</code> method, we're going to call a new method called <code>configureView</code>.</p>
<pre><code class="java">// app/java/sample.oddworks.com.myoddworksapplication/HomeActivity

// ...
private void configureView() {
    ImageView featuredMediaPreviewImage = (ImageView) findViewById(R.id.featuredMediaPreviewImage);
    Glide.with(context)
            .load(featuredMedia.getMediaImage().getAspect16x9())
            .placeholder(R.drawable.preview_tile_16x9)
            .into(featuredMediaPreviewImage);
}
// ...
</code></pre>

<p>We've created an <code>ImageView</code> with an ID of <code>featuredMediaPreviewImage</code> in the <code>activity_home</code> layout file that is being targeted in the <code>configureView</code> method. We want to use an image with an aspect ratio of 16x9, although we do have other options. You'll also notice that we have set a placeholder via a drawable file. This is best practice because it allows for the view layout to have the correct structure on load instead of changing it after Glide has loaded the image from the <code>featuredMedia</code> object.</p>
<h3 id="creating-a-dynamic-recycler-view">Creating a Dynamic Recycler View</h3>
<p>Since the <code>featuredCollectionEntities</code> list can contain different types of <code>OddObject</code>s we'll need to create a dynamic <code>RecyclerView</code> to handle anything that gets put into it. For this example, we'll handle the case of the List containing <code>Media</code> and <code>OddCollection</code> objects. In order to make use of the <code>RecyclerView</code> class we'll need to add it to our dependencies in our <code>build.gradle</code> file:</p>
<pre><code>dependencies {
    // ...
    compile 'com.android.support:recyclerview-v7:+'
}
</code></pre>
<p>We'll add a <code>RecyclerView</code> to our <code>activity_home</code> layout file and then add to our <code>configureView</code> method:</p>
<pre><code class="java">private void configureView() {
    // ...

    RecyclerView featuredEntitiesRecyclerView = (RecyclerView) findViewById(R.id.featuredEntitiesRecyclerView);
    OddListAdapter oddListAdapter = new OddListAdapter(featuredCollectionEntities);
    LinearLayoutManager layoutManager = new LinearLayoutManager(this);
    layoutManager.setOrientation(LinearLayoutManager.VERTICAL);
    featuredEntitiesRecyclerView.setLayoutManager(layoutManager);
    featuredEntitiesRecyclerView.setAdapter(oddListAdapter);
}
</code></pre>

<p>The <code>OddListAdapter</code> doesn't currently exist, so let's create that class.</p>
<pre><code class="java">// app/java/sample.oddworks.com.myoddworksapplication/OddListAdapter

package sample.oddworks.com.myoddworksapplication;

import android.content.Context;
import android.support.v7.widget.RecyclerView;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;
import android.widget.TextView;

import java.util.List;

import io.oddworks.device.model.Media;
import io.oddworks.device.model.OddCollection;
import io.oddworks.device.model.OddObject;

public class OddListAdapter extends RecyclerView.Adapter&lt;OddListAdapter.ListItemViewHolder&gt; {
    private List&lt;OddObject&gt; oddObjects;

    public OddListAdapter(List&lt;OddObject&gt; oddObjects) {
        super();

        this.oddObjects = oddObjects;
    }

    @Override
    public ListItemViewHolder onCreateViewHolder(ViewGroup parent, int viewType) {
        View itemView = LayoutInflater.from(parent.getContext()).inflate(R.layout.list_item, parent, false);
        return new ListItemViewHolder(itemView);
    }

    @Override
    public void onBindViewHolder(ListItemViewHolder holder, int position) {
        OddObject oddObject = oddObjects.get(position);

        switch (oddObject.getType()) {
            case (OddObject.TYPE_LIVE_STREAM):
            case (OddObject.TYPE_VIDEO):
                Media oddMedia = (Media) oddObject;
                holder.title.setText(oddMedia.getTitle());
                break;
            case (OddObject.TYPE_COLLECTION):
                OddCollection oddCollection = (OddCollection) oddObject;
                holder.title.setText(oddCollection.getTitle());
                break;
        }
    }

    @Override
    public int getItemCount() {
        if (oddObjects == null) {
            return 0;
        } else {
            return oddObjects.size();
        }
    }

    public final static class ListItemViewHolder extends RecyclerView.ViewHolder {
        TextView title;

        public ListItemViewHolder(View itemView) {
            super(itemView);

            title = (TextView) itemView.findViewById(R.id.listItemTitle);
        }
    }
}
</code></pre>

<p>Everything in this adapter is pretty standard. What deserves attention is the switch statement in the <code>onBindViewHolder</code>. We use the <code>getType</code> method on our <code>oddObject</code> and compare it against any type that it could be. Based on what type it is, we cast the <code>oddObject</code> to a <code>Media</code> or <code>OddCollection</code> object.</p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../search/" class="btn btn-neutral float-right" title="Search">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../initialize_api_calls/" class="btn btn-neutral" title="Initialize API Calls"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
      <p>Odd Networks</p>
    
  </div>

  Built with <a href="http://www.mkdocs.org">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
	  
        </div>
      </div>

    </section>

  </div>

<div class="rst-versions" role="note" style="cursor: pointer">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
          <a href="https://github.com/oddnetworks/odd-sample-apps" class="icon icon-github" style="float: left; color: #fcfcfc"> GitHub</a>
      
      
        <span><a href="../initialize_api_calls/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../search/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>

</body>
</html>
